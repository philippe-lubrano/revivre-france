<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="REVIVRE-FRANCE - Association des personnes qui souffrent de Troubles Anxieux">
  <title>REVIVRE-FRANCE - Association Troubles Anxieux</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- <header>
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <div class="logo-main">REVIVRE-FRANCE</div>
          <div class="logo-sub">Association Troubles Anxieux</div>
        </div>
        <nav>
          <button class="mobile-toggle" aria-label="Menu">
            <span></span>
            <span></span>
            <span></span>
          </button>
          <ul class="nav-menu">
            <li><a href="#accueil">Accueil</a></li>
            <li><a href="#troubles">Troubles Anxieux</a></li>
            <li><a href="#services">Nos Services</a></li>
            <li><a href="#agenda">Agenda</a></li>
            <li><a href="#contact">Contact</a></li>
            <li><a href="#adhesion" class="btn-nav">Adh√©rer</a></li>
          </ul>
        </nav>
      </div>
    </div>
  </header> -->

  <div class="iframe-container">
  <main>
    <section class="hero" id="accueil">
      <div class="container">
        <h1>REVIVRE-FRANCE</h1>
        <p class="hero-subtitle">L'association des personnes qui souffrent de Troubles Anxieux</p>
        <p class="hero-description">Association ind√©pendante, soutenue par des professionnels en sant√© mentale.</p>
        <div class="hero-buttons">
          <a href="#adhesion" class="btn btn-primary">Adh√©rer √† l'Association</a>
          <a href="#don" class="btn btn-secondary">Faire un Don</a>
        </div>
      </div>
    </section>

    <section class="section" id="troubles">
      <div class="container">
        <h2 class="section-title">√Ä qui s'adresse notre association ?</h2>
        <p class="section-subtitle">Nous soutenons les personnes souffrant de diff√©rents types de troubles anxieux</p>
        <div class="grid grid-4">
          <div class="card">
            <div class="card-icon">üë•</div>
            <h3>Phobie Sociale</h3>
            <p>Peur intense des situations sociales et du jugement des autres</p>
          </div>
          <div class="card">
            <div class="card-icon">üò∞</div>
            <h3>Anxi√©t√© G√©n√©ralis√©e</h3>
            <p>Inqui√©tude excessive et persistante dans la vie quotidienne</p>
          </div>
          <div class="card">
            <div class="card-icon">üíì</div>
            <h3>Trouble Panique</h3>
            <p>Attaques de panique r√©currentes et impr√©visibles</p>
          </div>
          <div class="card">
            <div class="card-icon">üö™</div>
            <h3>Agoraphobie</h3>
            <p>Peur des espaces ouverts ou des situations dont il est difficile de s'√©chapper</p>
          </div>
        </div>
      </div>
    </section>

    <section class="section section-gray" id="services">
      <div class="container">
        <h2 class="section-title">Ce que nous proposons</h2>
        <p class="section-subtitle">Un accompagnement complet pour vous aider √† mieux vivre avec vos troubles anxieux</p>
        <div class="grid grid-3">
          <div class="card">
            <div class="card-icon">üí¨</div>
            <h3>Groupes de Parole</h3>
            <p>Rencontrez d'autres personnes dans un cadre bienveillant et sans jugement. Nos groupes de parole sont anim√©s par les pairs, sans professionnels de sant√©.</p>
          </div>
          <div class="card">
            <div class="card-icon">üå≥</div>
            <h3>Sorties</h3>
            <p>Participez √† des activit√©s en groupe pour briser l'isolement et reprendre confiance en vous dans un environnement soutenant.</p>
          </div>
          <div class="card">
            <div class="card-icon">üéì</div>
            <h3>Ateliers</h3>
            <p>D√©couvrez des techniques pratiques et des outils pour mieux g√©rer votre anxi√©t√© au quotidien.</p>
          </div>
          <div class="card">
            <div class="card-icon">üìö</div>
            <h3>Site d'Information</h3>
            <p>Acc√©dez √† une mine d'informations sur les troubles anxieux, les traitements et les ressources disponibles.</p>
          </div>
          <div class="card">
            <div class="card-icon">üé§</div>
            <h3>Conf√©rences</h3>
            <p>Assistez √† des conf√©rences anim√©es par des experts pour mieux comprendre les troubles anxieux.</p>
          </div>
          <div class="card">
            <div class="card-icon">ü§ù</div>
            <h3>Partenariats</h3>
            <p>Nous collaborons avec des professionnels de sant√© et d'autres associations pour vous offrir le meilleur soutien.</p>
          </div>
        </div>
      </div>
    </section>

    <section class="section section-blue">
      <div class="container">
        <div class="highlight-box">
          <h3>Une approche unique : les groupes de parole entre pairs</h3>
          <p>Nos groupes de parole sont anim√©s par les participants eux-m√™mes, sans la pr√©sence de professionnels de sant√©. Cette approche permet de cr√©er un espace d'√©change libre et authentique, o√π chacun peut partager son v√©cu sans crainte du jugement. Vous n'√™tes pas seul dans votre parcours.</p>
        </div>
      </div>
    </section>

    <section class="section" id="agenda">
      <div class="container">
        <h2 class="section-title">Prochains √©v√©nements</h2>
        <p class="section-subtitle">Rejoignez-nous lors de nos prochaines rencontres</p>
        <div id="agenda-events"><!-- dynamic events will be injected here --></div>

        <!-- Fallback static markup (will be shown if JS fails or while loading) -->
        <div id="agenda-fallback" class="grid grid-2">
        </div>
      </div>
    </section>

    <section class="section section-gray" id="adhesion">
      <div class="container">
        <h2 class="section-title">Vous pouvez nous aider</h2>
        <p class="section-subtitle">Votre soutien nous permet de continuer notre mission</p>
        <div class="grid grid-2">
          <div class="card card-cta">
            <h3>Adh√©rer √† l'association</h3>
            <p>Devenez membre de REVIVRE-FRANCE et participez activement √† la vie de l'association. Votre adh√©sion nous aide √† organiser plus d'√©v√©nements et √† soutenir davantage de personnes.</p>
            <a href="#adhesion" class="btn btn-primary">Adh√©rer maintenant</a>
          </div>
          <div class="card card-cta" id="don">
            <h3>Faire un don</h3>
            <p>Chaque contribution, quelle que soit sa taille, fait une diff√©rence. Votre don nous permet de maintenir nos activit√©s gratuites et accessibles √† tous.</p>
            <a href="#don" class="btn btn-primary">Faire un don</a>
          </div>
        </div>
      </div>
    </section>
  </main>
  </div>

  <script src="script.js"></script>
  <script>
    (function(){
      async function fetchAgenda() {
        const start = new Date();
        const end = new Date(start);
        end.setDate(end.getDate() + 7);
        
        const fmt = d => d.toISOString().slice(0,10);

        const apiUrl = 'https://api-proxy-revivre.philippe-lubranolavadera.workers.dev/';

        const controller = new AbortController();
        const timeout = setTimeout(() => controller.abort(), 10000);

        const form = new FormData();
        form.append('id', '129622');
        form.append('pageId', '580895');
        form.append('start', fmt(start));
        form.append('end', fmt(end));

        try {
          const res = await fetch(apiUrl, {
            method: 'POST',
            referrerPolicy: 'origin-when-cross-origin',
            signal: controller.signal,
            body: form
          });
          clearTimeout(timeout);

          if (!res.ok) throw new Error('HTTP ' + res.status);
          const data = await res.json();

          renderEvents(data);
        } catch (err) {
          console.warn('Agenda fetch failed:', err);
        }
      }

      function renderEvents(items) {
          if (!Array.isArray(items) || items.length === 0) return;
          const container = document.getElementById('agenda-events');
          if (!container) return;

          // keep only events whose title/name contains exactly "Groupe de Parole" (case-insensitive)
          const filtered = items
            .map(it => {
              const ds = it.date || it.start || it.eventDate || '';
              const t = new Date(ds);
              return Object.assign({}, it, { __ts: isNaN(t) ? null : t.getTime() });
            })
            .filter(it => it.__ts !== null);

          if (filtered.length === 0) return;

          // order by date ascending
          filtered.sort((a, b) => a.__ts - b.__ts);

          // clear any previous content and hide fallback
          container.innerHTML = '';
          const fallback = document.getElementById('agenda-fallback');
          if (fallback) fallback.style.display = 'none';

          const grid = document.createElement('div');
          grid.className = 'grid grid-2';

          filtered.forEach(it => {
            const card = document.createElement('div');
            card.className = 'event-card';

            const dateCol = document.createElement('div');
            dateCol.className = 'event-date';

            const day = document.createElement('div');
            day.className = 'day';
            const d = parseDateForDisplay(it.date || it.start || it.eventDate);
            day.textContent = d.day;

            const month = document.createElement('div');
            month.className = 'month';
            month.textContent = d.month;

            dateCol.appendChild(day);
            dateCol.appendChild(month);

            const content = document.createElement('div');
            content.className = 'event-content';

            const title = document.createElement('h3');
            title.textContent = it.title || it.name || 'Groupe de Parole';

            const info1 = document.createElement('p');
            info1.className = 'event-info';
            info1.textContent = it.location || it.venue || '';

            const info2 = document.createElement('p');
            info2.className = 'event-info';
            info2.textContent = it.time || it.startTime || '';

            const desc = document.createElement('p');
            desc.textContent = it.description || '';

            content.appendChild(title);
            if (info1.textContent) content.appendChild(info1);
            if (info2.textContent) content.appendChild(info2);
            if (desc.textContent) content.appendChild(desc);

            card.appendChild(dateCol);
            card.appendChild(content);

            grid.appendChild(card);
          });

          container.appendChild(grid);
      }

      function parseDateForDisplay(dateStr) {
        if (!dateStr) return { day: '', month: '' };
        const d = new Date(dateStr);
        if (isNaN(d)) return { day: '', month: '' };
        const day = String(d.getDate()).padStart(2,'0');
        const month = d.toLocaleString('fr-FR', { month: 'long' });
        return { day, month };
      }

      // run after DOM ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', fetchAgenda);
      } else {
        fetchAgenda();
      }
    })();
  </script>
</body>
</html>
